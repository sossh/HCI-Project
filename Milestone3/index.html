<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Parking Finder Prototype</title>
    <link rel="stylesheet" href="css/styles.css" />
    <link rel="stylesheet" href="css/lot-map.css" />
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
      integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
      crossorigin=""
    />
  </head>

  <body>
    <div class="top-row">
      <header>
        <h1>UM Park</h1>
      </header>

      <div class="lot-bar">
        <button class="lot-btn" id="prev-lot">⟨ Prev</button>
        <div class="lot-dropdown-container">
          <select id="lot-selector" class="lot-dropdown">
            <option>Lot A - Engineering</option>
            <option>Lot B - Agriculture</option>
            <option>Lot C - Science</option>
            <option>Lot D - Admin</option>
            <option>Lot E - Stadium</option>
          </select>

          <img
            src="images/arrowDropdown.png"
            class="lot-arrow"
            alt="Dropdown Arrow"
          />
        </div>
        <button class="lot-btn" id="next-lot">Next ⟩</button>
      </div>
    </div>

    <!-- Left Filter Sidebar -->
    <div class="container">
      <div class="sidebar">
        <!-- Building Selector Card -->
        <aside class="building-selector">
          <h2>Select Building</h2>

          <label for="building-list">Building:</label>
          <select id="building-list">
              <option value="none">None</option>
              <!-- dynamically populated buildings -->
          </select>

          <hr />

          <label for="distance-range">Distance (m):</label>
          <input
            type="range"
            id="distance-range"
            min="0"
            max="500"
            value="500"
          />
          <span id="distance-value">500m</span>
        </aside>

        <!-- Filters Card -->
        <aside class="filters">
          <h2>Filters</h2>

          <div class="scrollable">
            <h3>Permit Type</h3>

            <label>
              <span class="label-left">
                <input type="checkbox" id="faculty" />
                Faculty
              </span>
              <img src="images/faculty.png" alt="Faculty Icon" class="icon" />
            </label>

            <label>
              <span class="label-left">
                <input type="checkbox" id="student" />
                Student
              </span>
              <img src="images/student.png" alt="Student Icon" class="icon" />
            </label>

            <label>
              <span class="label-left">
                <input type="checkbox" id="visitor" />
                Visitor
              </span>
              <img src="images/visitor.png" alt="Visitor Icon" class="icon" />
            </label>

            <hr />

            <h3>Spot Features</h3>
            <label>
              <span class="label-left">
                <input type="checkbox" id="covered" />
                Covered
              </span>
              <img src="images/covered.png" alt="Bike Icon" class="icon" />
            </label>

            <label>
              <span class="label-left">
                <input type="checkbox" id="electric" />
                Electric
              </span>
              <img src="images/electric.png" alt="Electric Icon" class="icon" />
            </label>

            <label>
              <span class="label-left">
                <input type="checkbox" id="accessible" />
                Accessible
              </span>
              <img
                src="images/accessible.png"
                alt="Accessible Icon"
                class="icon"
              />
            </label>
          </div>

          <hr />

          <h3>Traffic:</h3>
          <input type="range" id="traffic-range" min="0" max="100" value="25" />
          <br />
          <span id="traffic-value">25</span>
        </aside>
      </div>

      <!-- Right side: lot bar above map -->
      <div class="right-panel">
        <main class="map-area">
          <div id="map-frame"></div>

          <div class="active-filters" id="active-filters">
            <!-- Icons will be inserted here via JS -->
          </div>
        </main>
      </div>
    </div>
    <!-- Lot Maps Overlay -->
    <div id="parking-overlay-container">
      <div id="top-bar">
        <h1 id="lot-name">Parking Lot</h1>
        <div class="top-bar-right">
          <div class="info-container">
            <button id="info-button">?</button>
            <div id="info" class="instructions show">
              <ul>
                <li>Click and drag to pan. Mouse wheel to zoom.</li>
                <li>Click spots to select.</li>
                <li>Only one spot can be selected at a time.</li>
              </ul>
            </div>
          </div>
          <div class="close-button-container">
            <button id="close-button">&times;</button>
          </div>
        </div>
      </div>

      <div id="lot-view">
        <div id="parking-lot"></div>
        <div id="legend-container">
          <div id="legend">
            <ul>
              <li><span class="spot"></span> Available</li>
              <li><span class="spot selected"></span> Selected</li>
              <li><span class="spot occupied"></span> Occupied</li>
              <li>
                <span class="spot accessible">
                  <img
                    src="./images/lot-map-accessible.svg"
                    class="accessible-icon"
                  />
                </span>
                Accessible
              </li>
              <li>
                <span class="spot ev">
                  <img src="./images/lot-map-electric.svg" class="ev-icon" />
                </span>
                EV Charging
              </li>
              <li>
                <span class="spot covered">
                  <img
                    src="./images/lot-map-covered.svg"
                    class="covered-icon"
                  />
                </span>
                Covered
              </li>
            </ul>
          </div>

          <button id="legend-button">
            Legend <span class="arrow">^</span>
          </button>
        </div>
      </div>

      <div id="bottom-bar">
        <div id="bottom-information">
          <span>
            Spot Selected:
            <strong id="selected-spots">0</strong>
          </span>
          <span>
            Total Price:
            <strong id="total-price">$0.00</strong>
          </span>
          <span>
            Available Spots:
            <strong id="total-spots">0</strong>
          </span>
        </div>
        <button id="buy-button">Buy Ticket</button>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/panzoom@9.4.0/dist/panzoom.min.js"></script>
    <script src="js/lot-maps.js"></script>
    <script src="parking.js"></script>
    <script src="js/buildings.js"></script>
    <script src="js/script.js"></script>
    <script src="leafLet.js"></script>

    <!-- Make sure you put this AFTER Leaflet's CSS -->
    <script
      src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
      integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
      crossorigin=""
    ></script>

    <script>
      var map = L.map("map-frame").setView(
        [49.808890627609614, -97.13210208927495],
        16
      );
      
      renderLeaflet();
      buildAreas();
      applyFilters();
    </script>
  </body>
</html>
